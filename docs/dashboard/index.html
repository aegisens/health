<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aegisens Dashboard | Hormonal Intelligence Preview</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/dark-mode.css" id="dark-mode-css" disabled>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="assets/images/favicon.ico" type="image/x-icon">
    <style>
        /* Login screen styles - inline for immediate load */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #fef7f0 0%, #ffe9e9 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            font-family: 'Inter', sans-serif;
            transition: opacity 0.5s ease;
        }
        .login-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        .login-logo {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(90deg, #E07A9A, #9F7AEA);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .login-title {
            font-size: 2rem;
            color: #2D3748;
            margin-bottom: 10px;
        }
        .login-subtitle {
            color: #718096;
            max-width: 500px;
            text-align: center;
            margin-bottom: 40px;
            line-height: 1.6;
        }
        .password-form {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(224, 122, 154, 0.15);
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        .password-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #E2E8F0;
            border-radius: 50px;
            font-size: 1rem;
            margin-bottom: 20px;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
        }
        .password-input:focus {
            outline: none;
            border-color: #9F7AEA;
            box-shadow: 0 0 0 3px rgba(159, 122, 234, 0.2);
        }
        .password-input.error {
            border-color: #FC8181;
            animation: shake 0.5s;
        }
        .login-btn {
            background: linear-gradient(90deg, #E07A9A, #9F7AEA);
            color: white;
            border: none;
            padding: 16px 40px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            width: 100%;
        }
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(224, 122, 154, 0.3);
        }
        .login-hint {
            margin-top: 25px;
            color: #A0AEC0;
            font-size: 0.9rem;
        }
        .login-hint a {
            color: #9F7AEA;
            text-decoration: none;
        }
        .error-message {
            color: #FC8181;
            margin-top: 10px;
            font-size: 0.9rem;
            min-height: 20px;
        }
        @keyframes shake {
0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        /* Dashboard container - hidden until login */
        .dashboard-container {
            opacity: 0;
            transition: opacity 0.8s ease;
        }
        .dashboard-container.visible {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- LOGIN SCREEN -->
    <div class="login-screen" id="loginScreen">
        <div class="login-logo">Aegisens</div>
        <h1 class="login-title">Dashboard Preview</h1>
        <p class="login-subtitle">Early access to our hormonal intelligence platform. Enter password to continue.</p>
        
        <div class="password-form">
            <input type="password" class="password-input" id="passwordInput" placeholder="Enter access password" autocomplete="off">
            <div class="error-message" id="errorMessage"></div>
            <button class="login-btn" onclick="checkPassword()">Access Dashboard</button>
        </div>
        
        <p class="login-hint">For access inquiries: <a href="mailto:hello@aegisens.com">hello@aegisens.com</a></p>
    </div>

    <!-- DASHBOARD (hidden until login) -->
    <div class="dashboard-container" id="dashboardContainer">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-left">
                <div class="logo">Aegisens<span class="logo-beta">Dashboard</span></div>
                <div class="user-greeting">
                    <h1>Hello, <span id="userName">Anna</span>! <span class="welcome-emoji">üßö‚Äç‚ôÄÔ∏è</span></h1>
                    <p class="energy-level">Your energy today: <span class="energy-value"><span id="energyLevel">7</span>/10</span></p>
                </div>
            </div>
            <div class="header-right">
                <button class="theme-toggle" id="themeToggle" title="Toggle dark/light mode">
                    <span class="theme-icon">üåô</span>
                </button>
                <button class="logout-btn" onclick="logout()" title="Log out">Log Out</button>
            </div>
        </header>

        <!-- Main Dashboard Grid -->
        <main class="dashboard-grid">
            <!-- Left Column -->
            <div class="column-left">
                <!-- Today's Recommendations -->
                <section class="card recommendations-card">
                    <div class="card-header">
                        <h2>‚ö°Ô∏è Today's Recommendations</h2>
                        <div class="card-actions">
                            <button class="shuffle-btn" id="shuffleRecipes" title="Shuffle recommendations">üé≤ Shuffle</button>
                        </div>
                    </div>
                    <div class="recipes-grid" id="recipesGrid">
                        <!-- Recipes loaded dynamically from recipes.js -->
                    </div>
                    <div class="card-footer">
                        <button class="btn-secondary" onclick="showAllRecipes()">View All Recipes</button>
                    </div>
                </section>

                <!-- Recipe Filters -->
                <section class="card filters-card">
                    <h3>Filter by Twist</h3>
                    <div class="filters-grid" id="filtersContainer">
                        <!-- Filters loaded dynamically -->
                    </div>
                </section>
            </div>

            <!-- Middle Column -->
            <div class="column-middle">
                <!-- Hormonal Calendar -->
                <section class="card calendar-card">
                    <div class="card-header">
                        <h2>üóìÔ∏è Hormonal Calendar</h2>
<div class="month-nav">
                            <button class="nav-btn" id="prevMonth">‚Äπ</button>
                            <span id="currentMonth">January 2025</span>
                            <button class="nav-btn" id="nextMonth">‚Ä∫</button>
                        </div>
                    </div>
                    <div class="calendar-container" id="calendarContainer">
                        <!-- Calendar loaded dynamically from calendar.js -->
                    </div>
                    <div class="calendar-legend">
                        <div class="legend-item"><span class="legend-color hormonal"></span> Hormonal</div>
                        <div class="legend-item"><span class="legend-color histamine"></span> Histamine</div>
                        <div class="legend-item"><span class="legend-color menopause"></span> Menopause</div>
                    </div>
                </section>

                <!-- AI Insight -->
                <section class="card insight-card">
                    <div class="card-header">
                        <h2>üí° AI Insight</h2>
                        <span class="insight-time">Today, 10:30 AM</span>
                    </div>
                    <div class="insight-content">
                        <p id="aiInsightText">Voice analysis indicates elevated stress markers. Try 5 minutes of deep breathing before lunch. Your HRV shows good recovery potential today.</p>
                    </div>
                    <div class="insight-actions">
                        <button class="btn-small" onclick="generateNewInsight()">New Insight</button>
                        <button class="btn-small btn-outline" onclick="saveInsight()">Save</button>
                    </div>
                </section>
            </div>

            <!-- Right Column -->
            <div class="column-right">
                <!-- User Metrics -->
                <section class="card metrics-card">
                    <h2>üìä Your Metrics</h2>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-label">HRV</div>
                            <div class="metric-value">68 <span class="metric-trend up">‚ÜóÔ∏è</span></div>
                            <div class="metric-note">Good recovery</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">Sleep</div>
                            <div class="metric-value">7.5h</div>
                            <div class="metric-note">Deep: 1.2h</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">Voice Stress</div>
                            <div class="metric-value">Low</div>
                            <div class="metric-note">Calm tone</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">Cycle Day</div>
                            <div class="metric-value">21</div>
                            <div class="metric-note">Luteal phase</div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <button class="btn-link" onclick="viewDetailedMetrics()">View Detailed Analytics ‚Üí</button>
                    </div>
                </section>

                <!-- Shopping List Generator -->
                <section class="card shopping-card">
                    <div class="card-header">
                        <h2>üìã Shopping List</h2>
                        <div class="selected-count">Selected: <span id="selectedCount">0</span></div>
</div>
                    <div class="shopping-instructions">
                        <p>Select recipes above, then generate your personalized shopping list.</p>
                    </div>
                    <div class="shopping-actions">
                        <button class="btn-primary" id="generateListBtn" disabled onclick="generateShoppingList()">
                            üõí Generate List
                        </button>
                        <button class="btn-secondary" onclick="clearSelections()">Clear All</button>
                    </div>
                    <div id="shoppingListPreview" class="shopping-preview"></div>
                </section>

                <!-- Aegisens Instinct Integration -->
                <section class="card instinct-card">
                    <div class="card-header">
                        <h2>üõçÔ∏è Aegisens Instinct</h2>
                        <span class="badge-sale">-20%</span>
                    </div>
                    <div class="instinct-content">
                        <p>Today in our shop: <strong>Hormonal Harmony Cookbook</strong> with your first 10 recipes, expanded with 40 more.</p>
                        <div class="instinct-cta">
                            <a href="/instinct.html" class="btn-instinct">Visit Shop ‚Üí</a>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Footer -->
        <footer class="dashboard-footer">
            <p>Aegisens Dashboard v1.0 ‚Ä¢ "Health That Senses You" ‚Ä¢ This is a preview version</p>
            <p class="footer-links">
                <a href="/">Home</a> ‚Ä¢ 
                <a href="/instinct.html">Shop</a> ‚Ä¢ 
                <a href="/tech-demo.html">Tech</a> ‚Ä¢ 
                <a href="mailto:hello@aegisens.com">Contact</a>
            </p>
        </footer>
    </div>

    <!-- JavaScript Files -->
    <script src="assets/js/auth.js"></script>
    <script src="assets/js/recipes.js"></script>
    <script src="assets/js/calendar.js"></script>
    <script src="assets/js/shopping-list.js"></script>
    
  <script>
    // ===== SIMPLE FIXED AUTH =====
    const CORRECT_PASSWORD = "AegisensStealth2025";
    
    // Make function available globally IMMEDIATELY
    window.checkPassword = function() {
        console.log("checkPassword called!"); // Debug
        const input = document.getElementById('passwordInput');
        const error = document.getElementById('errorMessage');
        
        if (!input || !error) {
            console.error("Elements not found!");
            alert("System error. Please refresh.");
            return;
        }
        
        const value = input.value.trim();
        console.log("Password attempt:", value);
        
        if (value === CORRECT_PASSWORD || value.toLowerCase() === 'alpaca') {
            // SUCCESS - visual feedback
            input.style.borderColor = "#48bb78";
            error.textContent = "‚úì Access granted!";
            error.style.color = "#48bb78";
            
            // Hide login, show dashboard
            document.getElementById('loginScreen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('dashboardContainer').style.display = 'block';
                document.getElementById('dashboardContainer').style.opacity = '1';
                
                // Load data
                if (window.loadRecipes) loadRecipes();
                if (window.initCalendar) initCalendar();
                
                // Save login
                localStorage.setItem('aegisens-login', 'true');
            }, 500);
            
        } else {
            // FAILURE - visual feedback
            input.style.borderColor = "#FC8181";
            input.style.animation = 'shake 0.5s';
            error.textContent = "‚úó Incorrect password. Try: " + CORRECT_PASSWORD;
            error.style.color = "#FC8181";
            
            // Clear animation
            setTimeout(() => {
                input.style.animation = '';
            }, 500);
        }
    };
    
    // ===== AUTO-SETUP =====
    document.addEventListener('DOMContentLoaded', function() {
        console.log("DOM loaded, setting up...");
        
        // 1. Focus on input
        const input = document.getElementById('passwordInput');
        if (input) {
            input.focus();
            
            // 2. Enter key support
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    console.log("Enter pressed");
                    window.checkPassword();
                }
            });
        }
        
        // 3. Auto-login if previously logged in
        if (localStorage.getItem('aegisens-login') === 'true') {
            console.log("Auto-login detected");
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('dashboardContainer').style.display = 'block';
            if (window.loadRecipes) loadRecipes();
            if (window.initCalendar) initCalendar();
        }
        
        // 4. Add shake animation if not present
        if (!document.querySelector('#shake-style')) {
            const style = document.createElement('style');
            style.id = 'shake-style';
            style.textContent = 
                @keyframes shake {
                    0%, 100% { transform: translateX(0); }
                    10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                    20%, 40%, 60%, 80% { transform: translateX(5px); }
                }
            ;
            document.head.appendChild(style);
        }
        
        console.log("Setup complete!");
    });
    
    // ===== LOGOUT =====
    window.logout = function() {
        localStorage.removeItem('aegisens-login');
        document.getElementById('dashboardContainer').style.opacity = '0';
        setTimeout(() => {
            document.getElementById('dashboardContainer').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'flex';
            setTimeout(() => {
                document.getElementById('loginScreen').style.opacity = '1';
                document.getElementById('passwordInput').focus();
            }, 50);
        }, 300);
    };
</script>
</body>
</html>
